(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32910,        919]
NotebookOptionsPosition[     30072,        851]
NotebookOutlinePosition[     30406,        866]
CellTagsIndexPosition[     30363,        863]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
The geodesic equations are given below (taken from Diff. Geo. of Curves and \
Surfaces shamelessly):\
\>", "Text",
 CellChangeTimes->{{3.714411377821896*^9, 
  3.7144114166923447`*^9}},ExpressionUUID->"2b453f88-b4b3-475f-bce1-\
a14ff97000ea"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[DifferentialD]", "2"], 
             SuperscriptBox["x", "i"]}], 
            RowBox[{"\[DifferentialD]", 
             SuperscriptBox["s", "2"]}]], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", ",", 
              RowBox[{"k", "=", "1"}]}], "2"], 
            RowBox[{
             SubscriptBox[
              SuperscriptBox["\[CapitalGamma]", "i"], "jk"], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SuperscriptBox["x", "j"]}], 
              RowBox[{"\[DifferentialD]", "s"}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SuperscriptBox["x", "k"]}], 
              RowBox[{"\[DifferentialD]", "s"}]]}]}]}], "=", 
          RowBox[{
           RowBox[{"0", "   ", "for", " ", "i"}], " ", "=", " ", "1"}]}], ",",
          "2"}]}
      },
      GridBoxAlignment->{"Columns" -> {{"Center"}}}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], 
  TraditionalForm]],ExpressionUUID->"edee3a44-8dd1-4d92-9553-a080bf17a264"]], \
"Text",
 CellChangeTimes->{{3.714411478992166*^9, 
  3.714411621686399*^9}},ExpressionUUID->"cc96ead1-c5c9-4441-8421-\
b1bd9a12b609"],

Cell[TextData[{
 "where the Christoffel symbols are the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[CapitalGamma]", "i"], "jk"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "586e841b-a758-4b3a-ad6b-6de1c433e461"],
 ", which characterize the metric on the surface in question. These equations \
are useful for our purposes because they hold for geodesics parameterized by \
arc length. These are second order ordinary differential equations, so they \
require boundary conditions. Since there are two coordinates ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["x", "1"], ",", 
     SuperscriptBox["x", "2"]}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ad735579-8d72-4922-b320-beb25d174adf"],
 ", we must have four boundary conditions (which we will simplify to three by \
assuming the first derivative has unit magnitude):"
}], "Text",
 CellChangeTimes->{{3.7144116633008204`*^9, 3.714411670392291*^9}, {
  3.7144117290919437`*^9, 3.714411783577001*^9}, {3.7144118566474543`*^9, 
  3.714411872975774*^9}, {3.714411954908184*^9, 3.71441199841072*^9}, {
  3.714412050033408*^9, 3.714412194125061*^9}, {3.714412344465028*^9, 
  3.714412370975882*^9}},ExpressionUUID->"525b7d55-8fa2-4fd6-a403-\
973dde6a9735"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{
           StyleBox["x",
            FontWeight->"Bold"], "(", "0", ")"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x", "1"], "(", "0", ")"}], ",", 
            RowBox[{
             SuperscriptBox["x", "2"], "(", "0", ")"}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            StyleBox["x",
             FontWeight->"Bold"], 
            StyleBox["'",
             FontWeight->"Plain"]}], 
           StyleBox[
            RowBox[{"(", "0", ")"}],
            FontWeight->"Plain"]}], 
          StyleBox["=",
           FontWeight->"Plain"], 
          RowBox[{
           StyleBox["(",
            FontWeight->"Plain"], 
           RowBox[{
            RowBox[{
             StyleBox["cos\[Theta]",
              FontWeight->"Plain"], 
             StyleBox[" ",
              FontWeight->"Plain"], 
             StyleBox["u",
              FontWeight->"Bold"]}], ",", 
            RowBox[{"sin\[Theta]", " ", 
             StyleBox["v",
              FontWeight->"Bold"]}]}], ")"}]}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{"="}}}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], 
  TraditionalForm]],ExpressionUUID->"ec25514c-a642-4eb2-893a-d4567d68a3fe"]], \
"Text",
 CellChangeTimes->{{3.714412218087628*^9, 
  3.714412337042656*^9}},ExpressionUUID->"7ac21b7e-7ec2-489b-bc45-\
be724b2acd64"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["u",
     FontWeight->"Bold"], ",", 
    StyleBox["v",
     FontWeight->"Bold"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b1dc999a-0636-49c0-8c44-36bf6cdea0cd"],
 " are the unit coordinate vectors at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["x",
     FontWeight->"Bold"], "(", "0", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1ea9b0c5-e268-4412-9e4d-2c9d485d4fc9"],
 ".\nFor now, let\[CloseCurlyQuote]s skip the difficult part of determining \
the geodesic parameterization in terms of arc length (either analytically or \
numerically) and let\[CloseCurlyQuote]s assume that we have found a \
parameterization for a geodesic on our coordinate map that satisfies the \
above equations. Since this parameterization is parameterized by arc length, \
we simply \[OpenCurlyQuote]step\[CloseCurlyQuote] along this geodesic for one \
step length ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d704cb0b-a225-41be-a774-9fbf252f2d21"],
 ":"
}], "Text",
 CellChangeTimes->{
  3.714412199836565*^9, {3.714412377919622*^9, 3.71441247726847*^9}, {
   3.714412651903801*^9, 3.7144126832149677`*^9}, {3.714413096497242*^9, 
   3.714413099608861*^9}},ExpressionUUID->"f347baa9-880d-4b94-8986-\
5e710127194c"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      SubscriptBox[
       StyleBox["p",
        FontWeight->"Bold"], 
       RowBox[{"n", "+", "1"}]], "=", 
      RowBox[{
       StyleBox["x",
        FontWeight->"Bold"], "(", "h", ")"}]}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], 
  TraditionalForm]],ExpressionUUID->"d83cf109-cf3c-4cb9-a297-219fecf23e57"]], \
"Text",
 CellChangeTimes->{{3.714412218087628*^9, 3.714412337042656*^9}, {
  3.71441248513496*^9, 
  3.714412503460306*^9}},ExpressionUUID->"e3a154a8-1b59-43d3-9481-\
7d3e4e629b54"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   StyleBox["x",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e28df15e-3a6b-462c-9f4a-3be356ed82bb"],
 " is the geodesic with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["x",
      FontWeight->"Bold"], "(", "0", ")"}], "=", 
    SubscriptBox[
     StyleBox["p",
      FontWeight->"Bold"], "n"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "8d60f293-0db7-42ad-b4e1-96eb3a0cd7c6"]
}], "Text",
 CellChangeTimes->{{3.7144125097625723`*^9, 
  3.714412555427197*^9}},ExpressionUUID->"2e0ae7fb-335a-4282-b145-\
99a709dd8e88"],

Cell[TextData[{
 "This procedure allows us to define a step length ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fe7fd717-18a1-420e-b186-0345fca73053"],
 " and a random direction ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "36275fe7-52d5-4d7c-b77a-6b5973f9351e"],
 " for each step in our random walk (and thus perform a random walk on any \
surface that we can solve the geodesic equations for)"
}], "Text",
 CellChangeTimes->{{3.714412616591442*^9, 3.714412647511654*^9}, {
  3.714412700422011*^9, 
  3.714412720884942*^9}},ExpressionUUID->"80243687-0f95-4ae8-aa3f-\
c94e7c01e982"],

Cell[CellGroupData[{

Cell["Plane", "Subsection",
 CellChangeTimes->{{3.714413347905442*^9, 
  3.7144133486087*^9}},ExpressionUUID->"1ab08e6c-a766-4fc2-b0aa-4c3a3ef54ea9"],

Cell["\<\
The Christoffel symbols are identically zero for the entire plane. This leads \
rather quickly to the analytical solution for geodesics of the familiar line:\
\
\>", "Text",
 CellChangeTimes->{{3.714413355528845*^9, 
  3.714413389615962*^9}},ExpressionUUID->"ad2edf48-567f-4691-ac95-\
298169895972"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       StyleBox["x",
        FontWeight->"Bold"], 
       StyleBox["(",
        FontWeight->"Plain"], 
       StyleBox["s",
        FontWeight->"Plain"], 
       StyleBox[")",
        FontWeight->"Plain"]}], 
      StyleBox["=",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox[
        StyleBox["p",
         FontWeight->"Bold"], "0"], "+", 
       RowBox[{
        RowBox[{
         StyleBox["u",
          FontWeight->"Bold"], 
         StyleBox["(",
          FontWeight->"Plain"], 
         StyleBox["\[Theta]",
          FontWeight->"Plain"], 
         StyleBox[")",
          FontWeight->"Plain"]}], 
        StyleBox["s",
         FontWeight->"Plain"]}]}]}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], 
  TraditionalForm]],ExpressionUUID->"360d061f-6c80-4a00-b259-19a3dd724b05"]], \
"Text",
 CellChangeTimes->{{3.714412218087628*^9, 3.714412337042656*^9}, {
  3.71441248513496*^9, 3.714412503460306*^9}, {3.7144133981447277`*^9, 
  3.714413464078548*^9}},ExpressionUUID->"c5ab61a5-52eb-4981-b46f-\
0bcc803421e5"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["p",
     FontWeight->"Bold"], "0"], TraditionalForm]],ExpressionUUID->
  "75cbfc53-3d8b-4577-a443-78e5405eb86c"],
 " is the starting point and ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e0e8a43b-5903-4b3f-bc49-5143e1fb085a"],
 " is an angle from an x-axis. Thus we have the stepping function"
}], "Text",
 CellChangeTimes->{{3.7144134553417063`*^9, 
  3.714413531268153*^9}},ExpressionUUID->"940d71ed-e550-42f6-9d1e-\
8113d16f7fb3"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      SubscriptBox[
       StyleBox["p",
        FontWeight->"Bold"], 
       RowBox[{"n", "+", "1"}]], 
      StyleBox["=",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox[
        StyleBox["p",
         FontWeight->"Bold"], "n"], "+", 
       RowBox[{
        RowBox[{
         StyleBox["u",
          FontWeight->"Bold"], 
         StyleBox["(",
          FontWeight->"Plain"], 
         StyleBox["\[Theta]",
          FontWeight->"Plain"], 
         StyleBox[")",
          FontWeight->"Plain"]}], 
        StyleBox["h",
         FontWeight->"Plain"]}]}]}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], 
  TraditionalForm]],ExpressionUUID->"34259d17-a610-4f26-99c4-cdaced047b28"]], \
"Text",
 CellChangeTimes->{{3.714412218087628*^9, 3.714412337042656*^9}, {
  3.71441248513496*^9, 3.714412503460306*^9}, {3.7144133981447277`*^9, 
  3.714413464078548*^9}, {3.714413542813333*^9, 
  3.714413551908454*^9}},ExpressionUUID->"754679e6-d8ff-4e74-9c75-\
b27387f8e957"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"planewalk", "[", 
    RowBox[{"steplength_", ",", "numsteps_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "stepfunc", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"stepfunc", "[", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "\[Theta]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Theta]", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "+", 
             RowBox[{"steplength", "*", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
            RowBox[{"y", "+", 
             RowBox[{"steplength", "*", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NestList", "[", "\[IndentingNewLine]", 
       RowBox[{"stepfunc", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        "numsteps"}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"planehist", "[", 
     RowBox[{"steplength_", ",", "numsteps_"}], "]"}], "[", "numpts_", "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"planewalk", "[", 
            RowBox[{"steplength", ",", "numsteps"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", "numpts", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Histogram", "[", 
       RowBox[{"{", "data", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.714413594869421*^9, 3.714413914850059*^9}, {
   3.714762175192156*^9, 3.714762207861618*^9}, 3.714762243220236*^9, {
   3.714762394985923*^9, 3.714762396248605*^9}, {3.714762624652907*^9, 
   3.7147626284846573`*^9}},ExpressionUUID->"395ecf61-6d57-4cb0-af54-\
5d6fcd1b53fc"],

Cell["\<\
From here on, it will be easier to develop code for a more general 2D \
manifold and apply it to different manifolds with different coordinate maps. \
(Most of this code and equations are taken from [Geodesics Using Mathematica \
by Lewis]. The equations we will use are\
\>", "Text",
 CellChangeTimes->{{3.714765058309765*^9, 3.714765138092313*^9}, {
  3.7147653714903803`*^9, 
  3.714765378713826*^9}},ExpressionUUID->"6210707c-c995-4c5c-91fe-\
4fc21118a88e"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "=", "p"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", "'"}], "=", "q"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "'"}], "=", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], 
            RowBox[{
             SubscriptBox[
              StyleBox["x",
               FontWeight->"Bold"], "u"], "\[CenterDot]", 
             SubscriptBox[
              StyleBox["x",
               FontWeight->"Bold"], "u"]}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "uu"], "\[CenterDot]", 
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "u"]}], 
              SuperscriptBox["p", "2"]}], "+", 
             RowBox[{"2", 
              RowBox[{
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "uv"], "\[CenterDot]", 
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "u"]}], "p", " ", "q"}], "+", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "vv"], "\[CenterDot]", 
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "u"]}], 
              SuperscriptBox["q", "2"]}]}], ")"}]}]}], "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"q", "'"}], "=", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], 
            RowBox[{
             SubscriptBox[
              StyleBox["x",
               FontWeight->"Bold"], "v"], "\[CenterDot]", 
             SubscriptBox[
              StyleBox["x",
               FontWeight->"Bold"], "v"]}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "uu"], "\[CenterDot]", 
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "v"]}], 
              SuperscriptBox["p", "2"]}], "+", 
             RowBox[{"2", 
              RowBox[{
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "uv"], "\[CenterDot]", 
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "v"]}], "p", " ", "q"}], "+", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "vv"], "\[CenterDot]", 
               SubscriptBox[
                StyleBox["x",
                 FontWeight->"Bold"], "v"]}], 
              SuperscriptBox["q", "2"]}]}], ")"}]}]}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{"="}}}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], 
  TraditionalForm]],ExpressionUUID->"135887dc-ca16-43c2-969a-9768a5c308f9"]], \
"Text",
 CellChangeTimes->{{3.714765167964666*^9, 
  3.7147653440785933`*^9}},ExpressionUUID->"f7ecb44e-b7ca-47ea-91fe-\
53258288941c"],

Cell[TextData[{
 "where ",
 StyleBox["x ",
  FontWeight->"Bold"],
 "is the coordinate map from the u-v plane onto the 2D manifold. These \
equations are a system of four first order ordinary differential equations. \
We use a similar procedure used as in [Lewis] to translate this system of \
equations to Mathematica:"
}], "Text",
 CellChangeTimes->{{3.714765382512278*^9, 3.7147654030798283`*^9}, {
  3.714765435543318*^9, 3.7147654595017548`*^9}, {3.714765495078827*^9, 
  3.714765527229508*^9}, {3.7147657095664577`*^9, 
  3.714765714533298*^9}},ExpressionUUID->"18011d85-70e2-4e58-b32f-\
6fe2792d44cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "geodesicequations", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"geodesicequations", "[", "x_", "]"}], "[", 
     RowBox[{"u_", ",", "v_", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u0_:", "0"}], ",", 
        RowBox[{"v0_:", "0"}]}], "}"}], ",", "\[Theta]_"}], "]"}], "[", "s_", 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xu", ",", "xv", ",", "xuu", ",", "xuv", ",", "xvv"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xu", "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"u", ",", "v"}], "]"}], ",", "u"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xv", "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"u", ",", "v"}], "]"}], ",", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xuu", "=", 
       RowBox[{"D", "[", 
        RowBox[{"xu", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xuv", "=", 
       RowBox[{"D", "[", 
        RowBox[{"xu", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xvv", "=", 
       RowBox[{"D", "[", 
        RowBox[{"xv", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "''"}], "[", "s", "]"}], "==", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"xu", ".", "xu"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"xuu", ".", "xu"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u", "'"}], "[", "s", "]"}], ")"}], "2"]}], "+", 
             RowBox[{"2", 
              RowBox[{"xuv", ".", "xu"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "'"}], "[", "s", "]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"v", "'"}], "[", "s", "]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"xvv", ".", "xu"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "'"}], "[", "s", "]"}], ")"}], "2"]}]}], 
            ")"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "''"}], "[", "s", "]"}], "==", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"xv", ".", "xv"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"xuu", ".", "xv"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u", "'"}], "[", "s", "]"}], ")"}], "2"]}], "+", 
             RowBox[{"2", 
              RowBox[{"xuv", ".", "xv"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "'"}], "[", "s", "]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"v", "'"}], "[", "s", "]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"xvv", ".", "xv"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "'"}], "[", "s", "]"}], ")"}], "2"]}]}], 
            ")"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "[", "0", "]"}], "\[Equal]", "u0"}], ",", 
         RowBox[{
          RowBox[{"v", "[", "0", "]"}], "\[Equal]", "v0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "'"}], "[", "0", "]"}], "\[Equal]", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "'"}], "[", "0", "]"}], "\[Equal]", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nsteponce", "[", "geoeqns_", "]"}], "[", 
     RowBox[{"u_", ",", "v_", ",", "steplength_"}], "]"}], "[", "s_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uu", ",", "vv"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"uu", "[", "s", "]"}], ",", 
         RowBox[{"vv", "[", "s", "]"}]}], "}"}], "=", 
       RowBox[{"NDSolveValue", "[", " ", 
        RowBox[{"geoeqns", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u", "[", "s", "]"}], ",", 
           RowBox[{"v", "[", "s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "steplength"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uu", "[", "steplength", "]"}], ",", 
        RowBox[{"vv", "[", "steplength", "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.714765530217992*^9, 3.714765682118379*^9}, {
  3.714765718277842*^9, 3.71476575876538*^9}, {3.71476581344558*^9, 
  3.714766001207467*^9}, {3.7147660915817127`*^9, 3.714766524977762*^9}, {
  3.714766673881971*^9, 3.714766699232361*^9}, {3.714766737582478*^9, 
  3.714766939879107*^9}, {3.714767033291875*^9, 3.714767107798924*^9}, {
  3.714767145602619*^9, 3.7147672888742933`*^9}, {3.714767383496462*^9, 
  3.714767394022917*^9}},ExpressionUUID->"a8ad0bf4-78a4-410e-81ab-\
694b20d7d347"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sphere", ",", "geosphere"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sphere", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], 
        RowBox[{"Cos", "[", "v", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "v", "]"}], 
        RowBox[{"Sin", "[", "u", "]"}]}], ",", 
       RowBox[{"Sin", "[", "v", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"geosphere", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"geodesicequations", "[", "sphere", "]"}], "[", 
       RowBox[{"u", ",", "v", ",", 
        RowBox[{"{", 
         RowBox[{"u0", ",", "v0"}], "}"}], ",", "\[Theta]"}], "]"}], "[", "s",
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"nsteponce", "[", "geosphere", "]"}], "[", 
      RowBox[{"u", ",", "v", ",", 
       RowBox[{"\[Pi]", "/", "10"}]}], "]"}], "[", "s", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.714766009748665*^9, 3.7147660558046722`*^9}, {
  3.71476694836586*^9, 3.7147669594521093`*^9}, {3.714767165109839*^9, 
  3.714767193996791*^9}, {3.714767305050459*^9, 
  3.7147673383443327`*^9}},ExpressionUUID->"a9e39c26-16f6-4121-a386-\
191df73afe55"],

Cell[BoxData[
 TemplateBox[{
  "NDSolveValue","dvnoarg",
   "\"The function \\!\\(\\*RowBox[{\\\"v\\\"}]\\) appears with no arguments.\
\"",2,36,4,17103502534359671259,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.714767350298925*^9, 
  3.714767397657558*^9},ExpressionUUID->"47b84d03-f378-4d6f-97f3-\
17c18d1116b4"],

Cell[BoxData[
 TemplateBox[{
  "Set","shape",
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"uu$7286\\\", \
\\\"[\\\", \\\"s\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\"vv$7286\\\", \
\\\"[\\\", \\\"s\\\", \\\"]\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"NDSolveValue\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"2\\\", \\\" \\\", RowBox[{\\\"Tan\\\", \\\"[\\\", \
\\\"v\\\", \\\"]\\\"}], \\\" \\\", RowBox[{SuperscriptBox[\\\"u\\\", \\\"\
\[Prime]\\\", Rule[MultilineFunction, None]], \\\"[\\\", \\\"s\\\", \
\\\"]\\\"}], \\\" \\\", RowBox[{SuperscriptBox[\\\"v\\\", \\\"\[Prime]\\\", \
Rule[MultilineFunction, None]], \\\"[\\\", \\\"s\\\", \\\"]\\\"}]}], \\\"\
\[Equal]\\\", RowBox[{SuperscriptBox[\\\"u\\\", \\\"\[Prime]\[Prime]\\\", \
Rule[MultilineFunction, None]], \\\"[\\\", \\\"s\\\", \\\"]\\\"}]}], \
\\\",\\\", RowBox[{RowBox[{RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"v\\\", \
\\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"v\\\", \
\\\"]\\\"}], \\\" \\\", SuperscriptBox[RowBox[{SuperscriptBox[\\\"u\\\", \\\"\
\[Prime]\\\", Rule[MultilineFunction, None]], \\\"[\\\", \\\"s\\\", \
\\\"]\\\"}], \\\"2\\\"]}], \\\"+\\\", RowBox[{SuperscriptBox[\\\"v\\\", \\\"\
\[Prime]\[Prime]\\\", Rule[MultilineFunction, None]], \\\"[\\\", \\\"s\\\", \
\\\"]\\\"}]}], \\\"\[Equal]\\\", \\\"0\\\"}], \\\",\\\", RowBox[{\\\"u0\\\", \
\\\"\[Equal]\\\", RowBox[{\\\"u\\\", \\\"[\\\", \\\"0\\\", \\\"]\\\"}]}], \
\\\",\\\", RowBox[{\\\"v0\\\", \\\"\[Equal]\\\", RowBox[{\\\"v\\\", \
\\\"[\\\", \\\"0\\\", \\\"]\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"Cos\\\", \
\\\"[\\\", \\\"\[Theta]\\\", \\\"]\\\"}], \\\"\[Equal]\\\", \
RowBox[{SuperscriptBox[\\\"u\\\", \\\"\[Prime]\\\", Rule[MultilineFunction, \
None]], \\\"[\\\", \\\"0\\\", \\\"]\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"\[Theta]\\\", \\\"]\\\"}], \\\"\
\[Equal]\\\", RowBox[{SuperscriptBox[\\\"v\\\", \\\"\[Prime]\\\", \
Rule[MultilineFunction, None]], \\\"[\\\", \\\"0\\\", \\\"]\\\"}]}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"u\\\", \\\"[\\\
\", \\\"s\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\"v\\\", \\\"[\\\", \
\\\"s\\\", \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"s\\\", \\\",\\\", \\\"0\\\", \\\",\\\", FractionBox[\\\"\[Pi]\\\", \\\"10\
\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) are not the same shape.\"",2,36,5,
   17103502534359671259,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.714767350298925*^9, 
  3.714767397672635*^9},ExpressionUUID->"072f3fd1-bc63-47e1-b80b-\
b8bc2fd1bddf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uu$7286", "[", 
    FractionBox["\[Pi]", "10"], "]"}], ",", 
   RowBox[{"vv$7286", "[", 
    FractionBox["\[Pi]", "10"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7147660572077227`*^9, {3.714766262885569*^9, 3.714766281725184*^9}, 
   3.714766520105242*^9, {3.714766926129109*^9, 3.714766960833955*^9}, {
   3.714767161328002*^9, 3.714767166865711*^9}, 3.714767297154599*^9, 
   3.714767350316493*^9, 
   3.714767397673842*^9},ExpressionUUID->"551d8a43-1988-4fc4-960f-\
542763f19b8d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sphere", "Subsection",
 CellChangeTimes->{{3.71476286402985*^9, 
  3.71476286567797*^9}},ExpressionUUID->"1863643d-8469-43ee-a8d5-\
282e03d22a48"],

Cell["", "Text",
 CellChangeTimes->{{3.714762869302024*^9, 3.714762884532858*^9}, {
  3.714765045525178*^9, 
  3.714765048537051*^9}},ExpressionUUID->"eb4dc2af-b030-48a0-9364-\
345ef2e11a7b"]
}, Open  ]],

Cell["Torus", "Subsection",
 CellChangeTimes->{{3.714762853714737*^9, 
  3.7147628583094788`*^9}},ExpressionUUID->"53d846d5-0748-4013-8a30-\
6833e5b89236"]
},
WindowSize->{1280, 779},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 252, 6, 33, "Text", "ExpressionUUID" -> \
"2b453f88-b4b3-475f-bce1-a14ff97000ea"],
Cell[813, 28, 1408, 40, 47, "Text", "ExpressionUUID" -> \
"cc96ead1-c5c9-4441-8421-b1bd9a12b609"],
Cell[2224, 70, 1322, 28, 82, "Text", "ExpressionUUID" -> \
"525b7d55-8fa2-4fd6-a403-973dde6a9735"],
Cell[3549, 100, 1577, 51, 61, "Text", "ExpressionUUID" -> \
"7ac21b7e-7ec2-489b-bc45-be724b2acd64"],
Cell[5129, 153, 1405, 36, 99, "Text", "ExpressionUUID" -> \
"f347baa9-880d-4b94-8986-5e710127194c"],
Cell[6537, 191, 592, 19, 33, "Text", "ExpressionUUID" -> \
"e3a154a8-1b59-43d3-9481-7d3e4e629b54"],
Cell[7132, 212, 674, 23, 33, "Text", "ExpressionUUID" -> \
"2e0ae7fb-335a-4282-b145-99a709dd8e88"],
Cell[7809, 237, 706, 17, 55, "Text", "ExpressionUUID" -> \
"80243687-0f95-4ae8-aa3f-c94e7c01e982"],
Cell[CellGroupData[{
Cell[8540, 258, 149, 2, 44, "Subsection", "ExpressionUUID" -> \
"1ab08e6c-a766-4fc2-b0aa-4c3a3ef54ea9"],
Cell[8692, 262, 309, 7, 33, "Text", "ExpressionUUID" -> \
"ad2edf48-567f-4691-ac95-298169895972"],
Cell[9004, 271, 1144, 39, 33, "Text", "ExpressionUUID" -> \
"c5ab61a5-52eb-4981-b46f-0bcc803421e5"],
Cell[10151, 312, 584, 17, 33, "Text", "ExpressionUUID" -> \
"940d71ed-e550-42f6-9d1e-8113d16f7fb3"],
Cell[10738, 331, 1074, 35, 33, "Text", "ExpressionUUID" -> \
"754679e6-d8ff-4e74-9c75-b27387f8e957"],
Cell[11815, 368, 2528, 66, 330, "Input", "ExpressionUUID" -> \
"395ecf61-6d57-4cb0-af54-5d6fcd1b53fc"],
Cell[14346, 436, 471, 9, 55, "Text", "ExpressionUUID" -> \
"6210707c-c995-4c5c-91fe-4fc21118a88e"],
Cell[14820, 447, 3351, 99, 131, "Text", "ExpressionUUID" -> \
"f7ecb44e-b7ca-47ea-91fe-53258288941c"],
Cell[18174, 548, 607, 13, 55, "Text", "ExpressionUUID" -> \
"18011d85-70e2-4e58-b32f-6fe2792d44cc"],
Cell[18784, 563, 5804, 158, 393, "Input", "ExpressionUUID" -> \
"a8ad0bf4-78a4-410e-81ab-694b20d7d347"],
Cell[CellGroupData[{
Cell[24613, 725, 1384, 37, 125, "Input", "ExpressionUUID" -> \
"a9e39c26-16f6-4121-a386-191df73afe55"],
Cell[26000, 764, 342, 8, 23, "Message", "ExpressionUUID" -> \
"47b84d03-f378-4d6f-97f3-17c18d1116b4"],
Cell[26345, 774, 2610, 39, 80, "Message", "ExpressionUUID" -> \
"072f3fd1-bc63-47e1-b80b-b8bc2fd1bddf"],
Cell[28958, 815, 545, 13, 79, "Output", "ExpressionUUID" -> \
"551d8a43-1988-4fc4-960f-542763f19b8d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29552, 834, 152, 3, 45, "Subsection", "ExpressionUUID" -> \
"1863643d-8469-43ee-a8d5-282e03d22a48"],
Cell[29707, 839, 191, 4, 33, "Text", "ExpressionUUID" -> \
"eb4dc2af-b030-48a0-9364-345ef2e11a7b"]
}, Open  ]],
Cell[29913, 846, 155, 3, 44, "Subsection", "ExpressionUUID" -> \
"53d846d5-0748-4013-8a30-6833e5b89236"]
}
]
*)

